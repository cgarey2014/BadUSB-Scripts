REM BadUSB Script: Rogue Access Point Detector
REM Description: Script to detect rogue access points based on stored SSIDs on a Windows machine.
REM Note: Use responsibly and ethically. Unauthorized access to systems is illegal.
REM Author: Chris Garey
REM Date: 06/26/2024

REM Opening Command Prompt as Admin
DELAY 500
GUI r
DELAY 500
STRING cmd
DELAY 500
CTRL-SHIFT ENTER
DELAY 1000
ALT y
DELAY 500

REM Setting up environment variables
STRING set whitelistFile=%TEMP%\WiFiWhitelist.txt
ENTER
DELAY 500

REM Initialize whitelist (if needed)
STRING echo NachoWifi_5G >> %whitelistFile%
ENTER
DELAY 500
STRING echo Starbucks >> %whitelistFile%
ENTER
DELAY 500
STRING echo VTECH_5854_10a2 >> %whitelistFile%
ENTER
DELAY 500

REM Grab SSIDs stored on the machine
STRING netsh wlan show profiles > %TEMP%\WiFiProfiles.txt
ENTER
DELAY 2000

REM Search for rogue access points and log them
STRING findstr /I /C:"All User Profile" %TEMP%\WiFiProfiles.txt > %TEMP%\ProfileNames.txt
ENTER
DELAY 500

STRING findstr /V /I /G:%whitelistFile% %TEMP%\ProfileNames.txt > %TEMP%\RogueAccessPoints.txt
ENTER
DELAY 500

REM Display rogue access points in Notepad
STRING notepad.exe %TEMP%\RogueAccessPoints.txt
ENTER
DELAY 500

REM Cleanup temporary files
STRING del %TEMP%\WiFiProfiles.txt
ENTER
DELAY 500
STRING del %TEMP%\ProfileNames.txt
ENTER
DELAY 500

REM Exiting Command Prompt
STRING exit
ENTER
